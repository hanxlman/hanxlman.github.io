__require=function e(t,o,r){function c(i,n){if(!o[i]){if(!t[i]){var a=i.split("/");if(a=a[a.length-1],!t[a]){var l="function"==typeof __require&&__require;if(!n&&l)return l(a,!0);if(s)return s(a,!0);throw new Error("Cannot find module '"+i+"'")}}var h=o[i]={exports:{}};t[i][0].call(h.exports,function(e){return c(t[i][1][e]||e)},h,h.exports,e,t,o,r)}return o[i].exports}for(var s="function"==typeof __require&&__require,i=0;i<r.length;i++)c(r[i]);return c}({Block:[function(e,t,o){"use strict";cc._RF.push(t,"c08d0R//69KM7+OAfVbo3fk","Block"),Object.defineProperty(o,"__esModule",{value:!0});var r=e("../Config"),c=function(){return function(){this.x=null,this.y=null,this.color=r.Color.red,this.index=0,this.stock=!1,this.direct=null,this.enableControl=!1,this.mainControl=!1,this.anotherPart=null,this.needDestroy=!1,this.beforeDestroyRender=!1}}();o.default=c,cc._RF.pop()},{"../Config":"Config"}],CompBlock:[function(e,t,o){"use strict";cc._RF.push(t,"c2ac3NxWQNGCbeXtXHjpOVr","CompBlock"),Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.frams=[],t.sprite=null,t}return __extends(t,e),t.prototype.start=function(){},t.prototype.setColor=function(e){this.sprite.spriteFrame=this.frams[e]},__decorate([s(cc.SpriteFrame)],t.prototype,"frams",void 0),__decorate([s(cc.Sprite)],t.prototype,"sprite",void 0),t=__decorate([c],t)}(cc.Component);o.default=i,cc._RF.pop()},{}],CompGameOver:[function(e,t,o){"use strict";cc._RF.push(t,"24163FwqghIcple/JbngDb0","CompGameOver"),Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nodes=[],t.curIndex=0,t}return __extends(t,e),t.prototype.start=function(){},t.prototype.setOverType=function(e){this.type=e;for(var t=0;t<this.nodes.length;++t)this.nodes[t].active=t==e;this.setIndex(0)},t.prototype.setIndex=function(e){if(!(e<0||e>1)){this.curIndex=e;var t=[];t[0]=cc.find("btn1",this.nodes[this.type]),t[1]=cc.find("btn2",this.nodes[this.type]);for(var o=0;o<t.length;++o){var r=t[o].getComponent(cc.Animation),c=r.getClips()[0].name;if(e==o)r.play(c);else r.getAnimationState(c).time=0,r.sample(c),r.stop()}}},__decorate([s(cc.Node)],t.prototype,"nodes",void 0),t=__decorate([c],t)}(cc.Component);o.default=i,cc._RF.pop()},{}],CompRat:[function(e,t,o){"use strict";cc._RF.push(t,"e0401bW/XFPgZS2PcpTvcoy","CompRat"),Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.frams=[],t.sprite=null,t}return __extends(t,e),t.prototype.start=function(){},t.prototype.setColor=function(e){this.sprite.spriteFrame=this.frams[e]},__decorate([s(cc.SpriteFrame)],t.prototype,"frams",void 0),__decorate([s(cc.Sprite)],t.prototype,"sprite",void 0),t=__decorate([c],t)}(cc.Component);o.default=i,cc._RF.pop()},{}],Config:[function(e,t,o){"use strict";cc._RF.push(t,"cebcefPCB9H4JoBnh277hPa","Config"),Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function e(){}return e.maxStage=20,e}();o.default=r,function(e){e[e.up=0]="up",e[e.down=1]="down",e[e.left=2]="left",e[e.right=3]="right"}(o.Direct||(o.Direct={})),function(e){e[e.game_single=0]="game_single",e[e.game_double=1]="game_double"}(o.GameMode||(o.GameMode={})),function(e){e[e.red=0]="red",e[e.yellow=1]="yellow",e[e.black=2]="black",e[e.blue=3]="blue",e[e.green=4]="green"}(o.Color||(o.Color={})),function(e){e[e.sl=0]="sl",e[e.sb=1]="sb",e[e.sx=2]="sx",e[e.cg=3]="cg"}(o.GameOverType||(o.GameOverType={}));var c=function(){function e(){}return e.row=16,e.col=12,e.ratLevel=1,e.fallSpeedLevel=1,e}();o.GameConfig=c,cc._RF.pop()},{}],DataMgr:[function(e,t,o){"use strict";cc._RF.push(t,"a2a45L0QvtJnKnImOoSeffs","DataMgr"),Object.defineProperty(o,"__esModule",{value:!0});var r=e("./Config"),c=function(){function e(){}return e.loadData=function(){var e=cc.sys.localStorage.getItem("userData");e?this.userData=JSON.parse(e):(this.initData(),cc.sys.localStorage.setItem("userData",JSON.stringify(this.userData)))},e.initData=function(){this.userData[0]={star:0,lock:!1};for(var e=1;e<r.default.maxStage;e++)this.userData[e]={star:0,lock:!0}},e.setData=function(e){var t=e.index,o=void 0===t?1:t,c=e.lock,s=e.star;return!(o<0||o>=r.default.maxStage)&&(this.userData[o].lock=c,s&&(this.userData[o].star=s),cc.sys.localStorage.setItem("userData",JSON.stringify(this.userData)),!0)},e.isLock=function(e){return!(e<0||e>=r.default.maxStage)&&this.userData[e].lock},e.getStar=function(e){return!(e<0||e>=r.default.maxStage)&&this.userData[e].star},e.delData=function(){cc.sys.localStorage.removeItem("userData")},e.setMusic=function(e){this.bMusic=e},e.userData=[],e.bMusic=!0,e}();o.default=c,cc._RF.pop()},{"./Config":"Config"}],Egg:[function(e,t,o){"use strict";var r;cc._RF.push(t,"5aa08uwmT5J0pN8Yd6ZeKRt","Egg"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e[e.lock=0]="lock",e[e.select=1]="select",e[e.unSelect=2]="unSelect"}(r||(r={}));var c=cc._decorator,s=c.ccclass,i=c.property,n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.chickFrames=[],t.chick=null,t.num=null,t.select=null,t.shake=null,t.bLock=!0,t}return __extends(t,e),t.prototype.onLoad=function(){this.setLock(!0),this.showSelect(!1),this.setStr("0")},t.prototype.start=function(){},t.prototype.setLock=function(e){this.bLock=e,e?(this.changeState(r.lock),this.num.node.active=!1):(this.changeState(r.unSelect),this.num.node.active=!0),this.chick.node.active=!0,this.select.active=!1,this.shake.active=!1},t.prototype.setStr=function(e){this.num.string=e},t.prototype.showSelect=function(e){var t=this.select.getComponent(cc.Animation),o=this.shake.getComponent(cc.Animation);e?this.bLock?(this.select.active=!0,this.shake.active=!1,t.play("select")):(this.chick.node.active=!1,this.select.active=!0,this.shake.active=!0,t.playAdditive("select"),o.playAdditive("eggShake")):this.setLock(this.bLock)},t.prototype.changeState=function(e){this.chick.spriteFrame=this.chickFrames[e]},__decorate([i(cc.SpriteFrame)],t.prototype,"chickFrames",void 0),__decorate([i(cc.Sprite)],t.prototype,"chick",void 0),__decorate([i(cc.Label)],t.prototype,"num",void 0),__decorate([i(cc.Node)],t.prototype,"select",void 0),__decorate([i(cc.Node)],t.prototype,"shake",void 0),t=__decorate([s],t)}(cc.Component);o.default=n,cc._RF.pop()},{}],Game:[function(e,t,o){"use strict";cc._RF.push(t,"8d4090eQXlAmbRNHLWNFNPW","Game"),Object.defineProperty(o,"__esModule",{value:!0});var r=e("../Config"),c=e("../game/Rat"),s=e("../game/Block"),i=function(){function e(){this.blockCount=0,this.naturalFallFrequency=20,this.controlFallFrequency=null,this.destroyPillAndVirusFrequency=20,this.preparePillFrequency=10,this.rats=[],this.blocks=[],this.prepairBlocks=[],this.isPaused=!1,this.gamePhase=null,this.gameEnd=!1,this.nextPillMakeData=null}return e.setLevel=function(e){this.level=e},e.setGameMode=function(e){this.mode=e},e.prototype.setBlockSize=function(e){var t=e.height,o=e.width;this.blockWidth=o/r.GameConfig.col,this.blockHeight=t/r.GameConfig.row},e.prototype.getPosFromXY=function(e,t){return cc.v2(this.blockWidth*e,this.blockHeight*t)},e.prototype.initData=function(){this.rats=[],this.ratCount=10,this.blockCount=0,this.controlFallFrequency=75-15*r.GameConfig.fallSpeedLevel,this.colorCount=function(){for(var e=0;null!=r.Color[e];)e++;return e}(),this.createRats()},e.prototype.createRats=function(){for(var e=function(e){for(var t=function(){for(var e=[],t=0;t<r.GameConfig.col;t++)for(var o=0;o<=Math.floor(r.GameConfig.row/2);o++)e.push({x:t,y:o});return e}(),o=[],c=0;c<e;c++)o.push(t.splice(Math.floor(Math.random()*t.length),1)[0]);return o}(this.ratCount),t=0;t<e.length;t++){var o=new c.default;o.x=e[t].x,o.y=e[t].y,o.color=Math.floor(Math.random()*this.colorCount),o.index=t,this.rats.push(o)}},e.prototype.checkGamePhase=function(){return this.isAllStock()?this.isMatchLine()?"destroyPillAndVirus":"preparePill":this.hasControlPill()?"controlFall":"naturalFall"},e.prototype.isAllStock=function(){for(var e=0;e<this.blocks.length;e++)if(0==this.blocks[e].stock)return!1;return!0},e.prototype.fall=function(){for(var e=0;e<this.blocks.length;e++)0==this.blocks[e].stock&&(this.blocks[e].y-=1)},e.prototype.isMatchLine=function(){return this.updateDestroyStatus(!1)},e.prototype.hasControlPill=function(){for(var e=0;e<this.blocks.length;e++)if(1==this.blocks[e].mainControl)return!0;return!1},e.prototype.getRatByXY=function(e,t){for(var o=0;o<this.rats.length;o++)if(this.rats[o].x==e&&this.rats[o].y==t)return this.rats[o];return null},e.prototype.getBlockByXY=function(e,t){for(var o=0;o<this.blocks.length;o++)if(this.blocks[o].x==e&&this.blocks[o].y==t)return this.blocks[o];return null},e.prototype.updateDestroyStatus=function(e){for(var t=0;t<this.blocks.length;t++){var o=[],r=this.blocks[t].x,c=this.blocks[t].y,s=this.blocks[t].color;o.push({x:r,y:c});var i=null,n=null,a=!0;do{c+=1,n=this.getRatByXY(r,c),null==(i=this.getBlockByXY(r,c))?null==n?a=!1:n.color==s?o.push({x:r,y:c}):a=!1:i.color==s?o.push({x:r,y:c}):a=!1}while(a);c=this.blocks[t].y,i=null,n=null,a=!0;do{c-=1,i=this.getBlockByXY(r,c),n=this.getRatByXY(r,c),null==i?null==n?a=!1:n.color==s?o.push({x:r,y:c}):a=!1:i.color==s?o.push({x:r,y:c}):a=!1}while(a);if(o.length>=4){if(0==e)return!0;for(var l=0;l<o.length;l++){var h=o[l].x,u=o[l].y,p=this.getBlockByXY(h,u);null!=p&&(p.needDestroy=!0,null!=p.anotherPart&&(p.anotherPart.anotherPart=null,p.anotherPart=null)),null!=(f=this.getRatByXY(h,u))&&(f.needDestroy=!0)}}o.length=0,c=this.blocks[t].y,o.push({x:r,y:c}),i=null,n=null,a=!0;do{r-=1,i=this.getBlockByXY(r,c),n=this.getRatByXY(r,c),null==i?null==n?a=!1:n.color==s?o.push({x:r,y:c}):a=!1:i.color==s?o.push({x:r,y:c}):a=!1}while(a);r=this.blocks[t].x,i=null,n=null,a=!0;do{r+=1,i=this.getBlockByXY(r,c),n=this.getRatByXY(r,c),null==i?null==n?a=!1:n.color==s?o.push({x:r,y:c}):a=!1:i.color==s?o.push({x:r,y:c}):a=!1}while(a);if(o.length>=3){if(0==e)return!0;for(var d=0;d<o.length;d++){h=o[d].x,u=o[d].y;var f,g=this.getBlockByXY(h,u);null!=g&&(g.needDestroy=!0,null!=g.anotherPart&&(g.anotherPart.anotherPart=null,g.anotherPart=null)),null!=(f=this.getRatByXY(h,u))&&(f.needDestroy=!0)}}}if(0==e)return!1},e.prototype.getPillMakeData=function(){var e=this,t=function(){return Math.floor(Math.random()*e.colorCount)};return[t(),t()]},e.prototype.getDestroyStep=function(){for(var e=0;e<this.blocks.length;e++)if(1==this.blocks[e].needDestroy)return 1==this.blocks[e].beforeDestroyRender?"destroy":"beforeDestroy"},e.prototype.getNeedDestroyBlockIndex=function(){for(var e=0;e<this.blocks.length;e++)if(1==this.blocks[e].needDestroy)return e;return-1},e.prototype.getNeedDestroyRatIndex=function(){for(var e=0;e<this.rats.length;e++)if(1==this.rats[e].needDestroy)return e;return-1},e.prototype.updateblockstockStatus=function(){for(var e=0;e<this.blocks.length;e++)0==this.blocks[e].y&&(this.blocks[e].stock=!0,this.blocks[e].enableControl=!1,this.blocks[e].mainControl=!1);for(e=0;e<this.blocks.length;e++){var t=this.getBlockByXY(this.blocks[e].x,this.blocks[e].y-1);null!=this.getRatByXY(this.blocks[e].x,this.blocks[e].y-1)?0==this.blocks[e].stock&&(this.blocks[e].stock=!0,this.blocks[e].enableControl=!1,this.blocks[e].mainControl=!1,e=-1):null!=t&&1==t.stock&&0==this.blocks[e].stock&&(this.blocks[e].stock=!0,this.blocks[e].enableControl=!1,this.blocks[e].mainControl=!1,e=-1)}for(e=0;e<this.blocks.length;e++){null!=(t=this.blocks[e].anotherPart)&&1==t.stock&&(this.blocks[e].stock=!0,this.blocks[e].enableControl=!1,this.blocks[e].mainControl=!1)}for(e=0;e<this.blocks.length;e++){t=this.getBlockByXY(this.blocks[e].x,this.blocks[e].y-1);null!=this.getRatByXY(this.blocks[e].x,this.blocks[e].y-1)?0==this.blocks[e].stock&&(this.blocks[e].stock=!0,this.blocks[e].enableControl=!1,this.blocks[e].mainControl=!1,e=-1):null!=t&&1==t.stock&&0==this.blocks[e].stock&&(this.blocks[e].stock=!0,this.blocks[e].enableControl=!1,this.blocks[e].mainControl=!1,e=-1)}for(e=0;e<this.blocks.length;e++){null!=(t=this.blocks[e].anotherPart)&&1==t.stock&&(this.blocks[e].stock=!0,this.blocks[e].enableControl=!1,this.blocks[e].mainControl=!1)}},e.prototype.updateblockstockStatusAfterDestroy=function(){for(var e=0;e<this.blocks.length;e++){var t=this.blocks[e].x,o=this.blocks[e].y-1;if(o>=0){var r=this.getBlockByXY(t,o);null==r?1==this.blocks[e].stock&&(this.blocks[e].stock=!1,e=-1):0==r.stock&&1==this.blocks[e].stock&&(this.blocks[e].stock=!1,e=-1)}}},e.prototype.destroyPill=function(){switch(this.getDestroyStep()){case"beforeDestroy":for(var e=0;e<this.blocks.length;e++)1==this.blocks[e].needDestroy&&(this.blocks[e].beforeDestroyRender=!0);for(var t=0;t<this.rats.length;t++)1==this.rats[t].needDestroy&&(this.rats[t].beforeDestroyRender=!0);break;case"destroy":for(var o=void 0,r=[],c=[];-1!=(o=this.getNeedDestroyBlockIndex());)c.push(this.blocks.splice(o,1)[0]);for(;-1!=(o=this.getNeedDestroyRatIndex());)0,r.push(this.rats.splice(o,1)[0]);return this.updateblockstockStatusAfterDestroy(),0==this.rats.length&&this.gameWin(),{rat:r,block:c}}},e.prototype.gameWin=function(){this.gamePhase="WIN",this.setGameEnd(!0)},e.prototype.isGameOver=function(){var e=!1,t=this.getBlockByXY(6,r.GameConfig.row),o=this.getBlockByXY(7,r.GameConfig.row);return(null!=t&&1==t.stock||null!=o&&1==o.stock)&&(e=!0),e},e.prototype.gameOver=function(){this.gamePhase="GAME OVER",this.isPaused=!0,this.setGameEnd(!0)},e.prototype.setGameEnd=function(e){this.gameEnd=e},e.prototype.addBlock=function(){var e=new s.default,t=new s.default;e.x=6,e.y=r.GameConfig.row,e.color=this.nextPillMakeData[0],e.direct=r.Direct.left,e.enableControl=!0,e.mainControl=!0,e.anotherPart=t,e.index=this.blockCount++,t.x=7,t.y=r.GameConfig.row,t.color=this.nextPillMakeData[1],t.direct=r.Direct.right,t.enableControl=!0,t.anotherPart=e,t.index=this.blockCount++,this.blocks.push(e),this.blocks.push(t),this.nextPillMakeData=this.getPillMakeData(),this.gamePhase=this.checkGamePhase()},e.prototype.getControlBlocks=function(){for(var e=[],t=0;t<this.blocks.length;t++)1==this.blocks[t].enableControl&&e.push(this.blocks[t]);return 2==e.length?e:0==e.length?null:void console.error("enableControl pill amount error!!")},e.prototype.onMoveRight=function(){var e=this.getControlBlocks();if(null!=e){var t=e[0].mainControl?e[0]:e[1],o=e[0].mainControl?e[1]:e[0],c=t.direct,s=t.x,i=t.y,n=o.x,a=o.y;switch(c){case r.Direct.up:case r.Direct.down:s+=1,n+=1;break;case r.Direct.right:s+=1;break;case r.Direct.left:n+=1}var l=!0;if(c==r.Direct.up||c==r.Direct.down){if(s>=r.GameConfig.col||s<0||n>=r.GameConfig.col||n<0)l=!1;else null!=this.getBlockByXY(s,i)&&(l=!1),null!=this.getBlockByXY(n,a)&&(l=!1),null!=this.getRatByXY(s,i)&&(l=!1),null!=this.getRatByXY(n,a)&&(l=!1);1==l&&(t.x=s,t.y=i,o.x=n,o.y=a)}else if(c==r.Direct.right){if(s>=r.GameConfig.col)l=!1;else null!=this.getBlockByXY(s,i)&&(l=!1),null!=this.getRatByXY(s,i)&&(l=!1);1==l&&(o.x=t.x,o.y=t.y,t.x=s,t.y=i)}else if(c==r.Direct.left){if(n>=r.GameConfig.col)l=!1;else null!=this.getBlockByXY(n,a)&&(l=!1),null!=this.getRatByXY(n,a)&&(l=!1);1==l&&(t.x=o.x,t.y=o.y,o.x=n,o.y=a)}return l}return!1},e.prototype.onMoveLeft=function(){var e=this.getControlBlocks();if(null!=e){var t=e[0].mainControl?e[0]:e[1],o=e[0].mainControl?e[1]:e[0],c=t.direct,s=t.x,i=t.y,n=o.x,a=o.y;switch(c){case r.Direct.up:case r.Direct.down:s-=1,n-=1;break;case r.Direct.right:n-=1;break;case r.Direct.left:s-=1}var l=!0;if(c==r.Direct.up||c==r.Direct.down){if(s>=r.GameConfig.col||s<0||n>=r.GameConfig.col||n<0)l=!1;else null!=this.getBlockByXY(s,i)&&(l=!1),null!=this.getBlockByXY(n,a)&&(l=!1),null!=this.getRatByXY(s,i)&&(l=!1),null!=this.getRatByXY(n,a)&&(l=!1);1==l&&(t.x=s,t.y=i,o.x=n,o.y=a)}else if(c==r.Direct.right){if(n<0)l=!1;else null!=this.getBlockByXY(n,a)&&(l=!1),null!=this.getRatByXY(n,a)&&(l=!1);1==l&&(t.x=o.x,t.y=o.y,o.x=n,o.y=a)}else if(c==r.Direct.left){if(s<0)l=!1;else null!=this.getBlockByXY(s,i)&&(l=!1),null!=this.getRatByXY(s,i)&&(l=!1);1==l&&(o.x=t.x,o.y=t.y,t.x=s,t.y=i)}return l}return!1},e.prototype.onChangeDirect=function(){var e=this.getControlBlocks();if(null!=e){var t=e[0].mainControl?e[1]:e[0],o=t.anotherPart,c=null;switch(t.direct){case r.Direct.up:c=[r.Direct.right,r.Direct.down,r.Direct.left];break;case r.Direct.right:c=[r.Direct.down,r.Direct.left,r.Direct.up];break;case r.Direct.left:c=[r.Direct.up,r.Direct.right,r.Direct.down];break;case r.Direct.down:c=[r.Direct.left,r.Direct.up,r.Direct.down];break;default:console.error("unknown direction for change!!")}var s=null;do{s=c.shift();var i=o.x,n=o.y;switch(s){case r.Direct.up:n+=1;break;case r.Direct.right:i+=1;break;case r.Direct.left:i-=1;break;case r.Direct.down:n-=1}var a=!0;if(i<0||i>=r.GameConfig.col||n<0||n>=r.GameConfig.row)a=!1;else null!=this.getBlockByXY(i,n)&&(a=!1),null!=this.getRatByXY(i,n)&&(a=!1);if(1==a){switch(t.x=i,t.y=n,t.direct=s,s){case r.Direct.up:o.direct=r.Direct.down;break;case r.Direct.right:o.direct=r.Direct.left;break;case r.Direct.down:o.direct=r.Direct.up;break;case r.Direct.left:o.direct=r.Direct.right}return a}}while(null!=s)}return!1},e.level=1,e}();o.default=i,cc._RF.pop()},{"../Config":"Config","../game/Block":"Block","../game/Rat":"Rat"}],IControl:[function(e,t,o){"use strict";cc._RF.push(t,"f4adceTDjFHk6zSWPY+K2ok","IControl"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],NumLevel:[function(e,t,o){"use strict";cc._RF.push(t,"28f40I+/5ZIf7v83bYZvD+n","NumLevel"),Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.frames=[],t.sprite=null,t}return __extends(t,e),t.prototype.start=function(){},t.prototype.setNum=function(e){e<0||e>this.frames.length||(this.sprite.spriteFrame=this.frames[e])},__decorate([s(cc.SpriteFrame)],t.prototype,"frames",void 0),__decorate([s(cc.Sprite)],t.prototype,"sprite",void 0),t=__decorate([c],t)}(cc.Component);o.default=i,cc._RF.pop()},{}],Rat:[function(e,t,o){"use strict";cc._RF.push(t,"0fd11j9KP5CgrrLbh3VRPwt","Rat"),Object.defineProperty(o,"__esModule",{value:!0});var r=e("../Config"),c=function(){return function(){this.x=null,this.y=null,this.color=r.Color.red,this.index=0,this.needDestroy=!1,this.beforeDestroyRender=!1}}();o.default=c,cc._RF.pop()},{"../Config":"Config"}],Scene_fp:[function(e,t,o){"use strict";var r;cc._RF.push(t,"8b35de86OFD1ZR/884ZPWxg","Scene_fp"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e[e.single=0]="single",e[e.double=1]="double",e[e.help=2]="help",e[e.exit=3]="exit"}(r||(r={}));var c=cc._decorator,s=c.ccclass,i=c.property,n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btnArray=[],t.helpNode=null,t.curIndex=0,t}return __extends(t,e),t.prototype.start=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),this.curIndex=0,this.updateAni(),this.showHelp(!1);var e={1:"d",2:"a",5:"b"};e[2]=null;var t=[];t[0]=1,t[1]=3,t[3]=5,t[1]=null},t.prototype.onKeyDown=function(e){switch(e.keyCode){case 87:cc.log("w");break;case 83:cc.log("s");break;case 65:if(cc.log("a"),this.helpNode.active)return;this.curIndex=this.curIndex<=0?0:this.curIndex-1,this.updateAni();break;case 68:if(cc.log("d"),this.helpNode.active)return;this.curIndex=this.curIndex>=this.btnArray.length-1?this.btnArray.length-1:this.curIndex+1,this.updateAni();break;case 13:if(cc.log("enter"),this.helpNode.active)return;switch(this.curIndex){case r.single:cc.director.loadScene("scene_select"),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown);break;case r.double:break;case r.help:this.showHelp(!0);break;case r.exit:cc.director.end()}break;case 27:cc.log("esc"),this.helpNode.active&&this.showHelp(!1)}},t.prototype.updateAni=function(){for(var e=0;e<this.btnArray.length;e++){var t=this.btnArray[e].getComponent(cc.Animation),o=t.getClips()[0].name;if(e!=this.curIndex)t.getAnimationState(o).time=0,t.sample(o),t.stop();else t.play(o)}},t.prototype.showHelp=function(e){var t=this;if(this.helpNode.active!=e){e?(this.helpNode.stopAllActions(),this.helpNode.active=!0,this.helpNode.setScale(.1),this.helpNode.opacity=0,this.helpNode.runAction(cc.spawn(cc.fadeIn(.2),cc.scaleTo(.2,1)))):this.helpNode.runAction(cc.sequence(cc.spawn(cc.fadeOut(.2),cc.scaleTo(.2,.1)),cc.callFunc(function(){t.helpNode.active=!1})))}},__decorate([i([cc.Node])],t.prototype,"btnArray",void 0),__decorate([i(cc.Node)],t.prototype,"helpNode",void 0),t=__decorate([s],t)}(cc.Component);o.default=n,cc._RF.pop()},{}],Scene_game:[function(e,t,o){"use strict";cc._RF.push(t,"b618bq6g3NNB6WXLUk24jx5","Scene_game"),Object.defineProperty(o,"__esModule",{value:!0});var r=e("../Config"),c=e("../game/Game"),s=e("../DataMgr"),i=cc._decorator,n=i.ccclass,a=i.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gamePanel=null,t.nextNode=null,t.lableLevel=null,t.lableRest=null,t.Prat=null,t.Pblock=null,t.gameoverBox=null,t.frame=0,t.ratMap={},t.blockMap={},t}return __extends(t,e),t.prototype.start=function(){this.initData(),this.gameoverBox.active=!1,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},t.prototype.initData=function(){this.game=new c.default;var e=this.game;e.setBlockSize({height:this.gamePanel.height,width:this.gamePanel.width}),e.initData();for(var t=0;t<e.rats.length;++t){var o=e.rats[t],r=cc.instantiate(this.Prat);this.ratMap[o.index]=r,r.setPosition(e.getPosFromXY(o.x,o.y)),r.getComponent("CompRat").setColor(o.color),r.parent=this.gamePanel}},t.prototype.addBlock=function(){var e=this,t=this.game;t.isPaused=!0;var o=this.nextNode.x,r=this.nextNode.y,c=cc.rotateBy(.4,720,720),s=cc.moveBy(.4,cc.v2(0,200)),i=cc.callFunc(function(){t.isPaused=!1,t.addBlock();for(var o=0;o<2;++o){var r=cc.instantiate(e.Pblock),c=r.getComponent("CompBlock"),s=t.blocks[t.blocks.length-o-1];c.setColor(s.color),r.setPosition(t.getPosFromXY(s.x,s.y)),r.parent=e.gamePanel,e.blockMap[s.index]=r}e.renderGame(),e.frame=0});this.nextNode.runAction(cc.sequence(cc.spawn(s,c),i,cc.callFunc(function(){e.nextNode.x=o,e.nextNode.y=r})))},t.prototype.renderLevel=function(){this.lableLevel.getComponent("NumLevel").setNum(c.default.level)},t.prototype.renderRatCount=function(){this.lableRest.string="X "+this.game.rats.length},t.prototype.renderGame=function(){if(null!=this.game.nextPillMakeData)for(var e=0;e<this.game.nextPillMakeData.length;++e){this.nextNode.children[e].getComponent("CompBlock").setColor(this.game.nextPillMakeData[e])}for(e=0;e<this.game.blocks.length;e++){var t=this.game.blocks[e];this.blockMap[t.index].setPosition(this.game.getPosFromXY(t.x,t.y))}},t.prototype.update=function(e){var t=this.game;if(!t.isPaused&&!this.gameoverBox.active){switch(null==t.gamePhase&&(t.nextPillMakeData=t.getPillMakeData(),this.renderGame(),this.renderLevel(),this.renderRatCount(),t.gamePhase=t.checkGamePhase()),t.gamePhase){case"destroyPillAndVirus":if(this.frame>=t.destroyPillAndVirusFrequency){t.updateDestroyStatus(!0);var o=t.destroyPill();if(o){for(var i=0;i<o.rat.length;++i){var n=o.rat[i],a=this.ratMap[n.index];this.ratMap[n.index]=null,a.removeFromParent()}for(i=0;i<o.block.length;++i){var l=o.block[i];a=this.blockMap[l.index];this.blockMap[l.index]=null,a.removeFromParent()}}if(this.renderRatCount(),this.renderGame(),t.gameEnd)return t.isPaused=!0,s.default.setData({index:c.default.level+1,lock:!1,star:0}),void this.showGameOverPanel(r.GameOverType.cg);t.gamePhase=t.checkGamePhase(),this.frame=0}break;case"preparePill":if(this.frame>=t.preparePillFrequency){if(t.updateblockstockStatus(),t.isGameOver())return t.gameOver(),void this.showGameOverPanel(r.GameOverType.sb);this.addBlock()}break;case"controlFall":this.frame>=t.controlFallFrequency&&(t.updateblockstockStatus(),t.fall(),this.renderGame(),t.gamePhase=t.checkGamePhase(),this.frame=0);break;case"naturalFall":this.frame>=t.naturalFallFrequency&&(t.updateblockstockStatus(),t.fall(),this.renderGame(),t.gamePhase=t.checkGamePhase(),this.frame=0)}this.frame++}},t.prototype.reSet=function(){this.ratMap={},this.blockMap={},this.gamePanel.removeAllChildren(),this.gameoverBox.active=!1,this.initData()},t.prototype.onKeyDown=function(e){switch(e.keyCode){case 87:if(cc.log("w"),this.gameoverBox.active||this.game.gameEnd)(t=this.gameoverBox.getComponent("CompGameOver")).setIndex(0);break;case 83:if(cc.log("s"),this.gameoverBox.active||this.game.gameEnd)(t=this.gameoverBox.getComponent("CompGameOver")).setIndex(1);else this.onMoveDown();break;case 65:if(cc.log("a"),this.gameoverBox.active||this.game.gameEnd)return;this.game.onMoveLeft()&&this.renderGame();break;case 68:if(cc.log("d"),this.gameoverBox.active||this.game.gameEnd)return;this.game.onMoveRight()&&this.renderGame();break;case 13:if(cc.log("enter"),this.gameoverBox.active||this.game.gameEnd){var t;if(this.gameoverBox.active)switch((t=this.gameoverBox.getComponent("CompGameOver")).type){case r.GameOverType.cg:0==t.curIndex?(c.default.level++,this.reSet()):cc.director.loadScene("scene_fp");break;case r.GameOverType.sb:0==t.curIndex?this.reSet():cc.director.loadScene("scene_fp");break;case r.GameOverType.sl:0==t.curIndex||cc.director.loadScene("scene_fp");break;case r.GameOverType.sx:0==t.curIndex?this.gameoverBox.active=!1:cc.director.loadScene("scene_fp")}return}this.game.onChangeDirect()&&this.renderGame();break;case 27:cc.log("esc"),this.gameoverBox.active||this.game.gameEnd||this.showGamePausePanel()}},t.prototype.onMoveDown=function(){null!=this.game.getControlBlocks()&&(this.frame=this.game.controlFallFrequency)},t.prototype.showGameOverPanel=function(e){this.gameoverBox.active||(this.gameoverBox.active=!0,this.gameoverBox.getComponent("CompGameOver").setOverType(e))},t.prototype.showGamePausePanel=function(){this.gameoverBox.active||(this.gameoverBox.active=!0,this.gameoverBox.getComponent("CompGameOver").setOverType(r.GameOverType.sx))},__decorate([a(cc.Node)],t.prototype,"gamePanel",void 0),__decorate([a(cc.Node)],t.prototype,"nextNode",void 0),__decorate([a(cc.Node)],t.prototype,"lableLevel",void 0),__decorate([a(cc.Label)],t.prototype,"lableRest",void 0),__decorate([a(cc.Prefab)],t.prototype,"Prat",void 0),__decorate([a(cc.Prefab)],t.prototype,"Pblock",void 0),__decorate([a(cc.Node)],t.prototype,"gameoverBox",void 0),t=__decorate([n],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../Config":"Config","../DataMgr":"DataMgr","../game/Game":"Game"}],Scene_loading:[function(e,t,o){"use strict";cc._RF.push(t,"fe55dzY3LNAM4hwmmdEptw5","Scene_loading"),Object.defineProperty(o,"__esModule",{value:!0});var r=e("../DataMgr"),c=cc._decorator,s=c.ccclass,i=(c.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.start=function(){r.default.loadData(),this.scheduleOnce(function(){cc.director.loadScene("scene_fp")},3)},t.prototype.onKeyDown=function(e){switch(e.keyCode){case 87:cc.log("w");break;case 83:cc.log("s");break;case 65:cc.log("a");break;case 68:cc.log("d")}},t=__decorate([s],t)}(cc.Component));o.default=i,cc._RF.pop()},{"../DataMgr":"DataMgr"}],Scene_select:[function(e,t,o){"use strict";cc._RF.push(t,"23d17iTUK9IFaRtXvLsrW+j","Scene_select"),Object.defineProperty(o,"__esModule",{value:!0});var r=e("../DataMgr"),c=e("../Config"),s=e("../game/Game"),i=e("../Config"),n=cc._decorator,a=n.ccclass,l=n.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Page=null,t.Egg=null,t.pageView=null,t.curIndex=0,t.eggArray=[],t}return __extends(t,e),t.prototype.start=function(){this.initData(),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},t.prototype.initData=function(){this.eggArray=[];for(var e=null,t=r.default.userData,o=0;o<t.length;o++){o%10==0&&(e=cc.instantiate(this.Page),this.pageView.addPage(e));var c=cc.instantiate(this.Egg);c.parent=e;var s=c.getComponent("Egg");s.setLock(t[o].lock),s.setStr(o+1),this.eggArray[o]=c}for(o=t.length-1;o>=0;o--)if(!t[o].lock){this.curIndex=o,this.pageView.scrollToPage(Math.floor(this.curIndex/10),.2);break}this.updateSelect()},t.prototype.updateSelect=function(){for(var e=0;e<this.eggArray.length;++e){var t=this.eggArray[e].getComponent("Egg");e==this.curIndex?t.showSelect(!0):t.showSelect(!1)}},t.prototype.moveIndex=function(e){var t;switch(e){case c.Direct.up:(t=this.curIndex-5)>=10*Math.floor(this.curIndex/10)&&(this.curIndex=t,this.updateSelect());break;case c.Direct.down:(t=this.curIndex+5)<10*(Math.floor(this.curIndex/10)+1)&&(this.curIndex=t,this.updateSelect());break;case c.Direct.left:0==this.curIndex||5==this.curIndex||(10==this.curIndex||15==this.curIndex?(this.curIndex-=6,this.pageView.scrollToPage(Math.floor(this.curIndex/10),.2)):this.curIndex-=1),this.updateSelect();break;case c.Direct.right:14==this.curIndex||19==this.curIndex||(4==this.curIndex||9==this.curIndex?(this.curIndex+=6,this.pageView.scrollToPage(Math.floor(this.curIndex/10),.2)):this.curIndex+=1),this.updateSelect()}},t.prototype.onKeyDown=function(e){switch(e.keyCode){case 87:cc.log("w"),this.moveIndex(c.Direct.up);break;case 83:cc.log("s"),this.moveIndex(c.Direct.down);break;case 65:cc.log("a"),this.moveIndex(c.Direct.left);break;case 68:cc.log("d"),this.moveIndex(c.Direct.right);break;case 13:cc.log("enter"),r.default.userData[this.curIndex].lock||(s.default.setLevel(this.curIndex),s.default.setGameMode(i.GameMode.game_single),cc.director.loadScene("scene_game"));break;case 27:cc.log("esc"),cc.director.loadScene("scene_fp"),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown)}},__decorate([l(cc.Prefab)],t.prototype,"Page",void 0),__decorate([l(cc.Prefab)],t.prototype,"Egg",void 0),__decorate([l(cc.PageView)],t.prototype,"pageView",void 0),t=__decorate([a],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../Config":"Config","../DataMgr":"DataMgr","../game/Game":"Game"}]},{},["Config","DataMgr","Egg","IControl","NumLevel","CompBlock","CompGameOver","CompRat","Block","Game","Rat","Scene_fp","Scene_game","Scene_loading","Scene_select"]);